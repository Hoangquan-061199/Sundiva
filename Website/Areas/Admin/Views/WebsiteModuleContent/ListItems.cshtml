@model Website.Areas.Admin.ViewModels.WebsiteModuleViewModel
@using ADCOnline.Utils
@if (Model.SystemActionAdmin.View)
{
    <input type="hidden" id="TypeView" value="Module" />
    <div class="badge badge-info" style="margin-bottom:10px;cursor:pointer;" id="ShowAll">Xem hết danh mục</div>
    <div class="badge badge-warning" style="margin-bottom:10px;cursor:pointer;" id="HideAll">Ẩn danh mục</div>
    <table id="gridItems" class="table table-bordered table-hover">
        <thead>
            <tr role="row">
                <th>Tên</th>
                <th class="wd150">Kiểu hiển thị</th>
                <th class="wd100">Bài viết</th>
                <th class="wd100 text-center">
                    Thứ tự
                    @if (Model.SystemActionAdmin.Order == true)
                    {
                        <a href="javascript:" data-toggle="tooltip" data-placement="bottom" title="Chỉnh sửa số thư tự" class="EditOrderAll badge badge-primary"><span class="lnr lnr-pencil"></span></a>
                        <a href="javascript:" data-toggle="tooltip" data-placement="bottom" title="Lưu số thư tự đã chỉnh sửa" class="SaveAll badge badge-primary" style="display:none;"><i class="glyphicon glyphicon-floppy-disk"></i></a>
                    }
                </th>
                <th class="text-center wd150">Trạng thái</th>
                <th class="act_roles wd150 text-center">
                    <div class="btn-group">
                        <button type="button" class="btn btn-info btn-sm dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Thao tác <span class="fa fa-caret-down"></span></button>
                        <ul class="dropdown-menu dropdown-action" role="menu">
                            @if (Model.SystemActionAdmin.Active == true)
                            {
                                <li><a href="javascript:" class="showAll"><i class="lnr lnr-checkmark-circle"></i><span>Hiển thị</span></a></li>
                                <li><a href="javascript:" class="hideAll"><i class="lnr lnr-warning"></i><span>Ẩn</span></a></li>
                            }
                            @if (Model.SystemActionAdmin.Delete == true)
                            {
                                <li><a href="javascript:" class="deleteAll"><i class="lnr lnr-trash"></i><span>Xóa</span></a></li>
                            }
                            @if (Model.SystemActionAdmin.Sitemap == true)
                            {
                                <li><a href="javascript:" class="issitemapall"><i class="lnr lnr-checkmark-circle"></i><span>Thêm sitemap</span></a></li>
                                <li><a href="javascript:" class="notsitemapall"><i class="lnr lnr-warning"></i><span>Bỏ sitemap</span></a></li>
                            }
                            @*@if (Model.SystemActionAdmin.Edit == true)
                        {
                        <li><a href="javascript:" class="updateproducts"><i class="lnr lnr-trash"></i><span>Cập nhất số bài viết</span></a></li>
                        }*@
                            <li><a href="javascript:" class="resize"><i class="lnr lnr-pencil"></i><span>Resize</span></a></li>
                            <li><a href="javascript:" class="resize-album"><i class="lnr lnr-pencil"></i><span>Resize album</span></a></li>
                        </ul>
                    </div>
                </th>
                <th class="text-center wd50">
                    <div class="label-check">
                        <input type="checkbox" id="checkAll" class="minimal checkAll" value="">
                        <label for="checkAll"></label>
                    </div>
                </th>
            </tr>
        </thead>
        <tbody>
            @if (Model.ListItem != null && Model.ListItem.Count > 0)
            {
                if (Model.SearchModel != null && !string.IsNullOrEmpty(Model.SearchModel.keyword))
                {
                    foreach (var item in Model.ListItem.Where(x => x.ParentID == 0))
                    {
                        <tr id="item_@(item.ID)" class="@(item.IsShow != true ? "hid" : string.Empty)@(item.ID==Model.WebsiteModule.ID?" active":string.Empty)">
                            <td class="open-child active" data-id="@item.ID" data-level="1">
                                <span class="lnr lnr-chevron-down"></span>
                                @if (Model.SystemActionAdmin.Edit == true)
                                {
                                    <a href="#@item.ID" class="edit" data-tab="">
                                        @Html.Raw(Utility.DisplayShowName(item.Name, item.IsShow))
                                    </a>
                                }
                                @if (Model.ListItem.Count(x => x.ParentID == item.ID) > 0)
                                {
                                    <span class="badge badge-danger" style="margin-left:5px;">@Model.ListItem.Count(x => x.ParentID == item.ID)</span>
                                }
                            </td>
                            <td>@item.ModuleType</td>
                            <td>
                                @if (Model.ListModule.Any(x => x.Tag == "WebsiteContent"))
                                {
                                    <a href="/Adminadc/WebsiteContent/Index#ModuleId=@item.ID" class="color-info">Tới bài viết</a>
                                }
                            </td>
                            <td>
                                @if (Model.SystemActionAdmin.Order)
                                {
                                    <input type="number" class="InputOrderDisplay form-control" name="OrderDisplay" onchange="changeOrder('@item.ID', this.value)" value="@item.OrderDisplay" disabled />
                                }
                                else
                                {
                                    @item.OrderDisplay
                                }
                            </td>
                            <td class="text-center">
                                @if (Model.SystemActionAdmin.Active == true)
                                {
                                    <a href="#@item.ID" class="@(ConvertUtil.ToBool(item.IsShow)==true?"hiddens":"show")">@Html.Raw(StaticEnum.Show(item.IsShow))</a>
                                }
                                else
                                {
                                    @Html.Raw(StaticEnum.Show(item.IsShow))
                                }
                                @if (Model.SystemActionAdmin.Sitemap == true)
                                {
                                    <a href="#@item.ID" class="sitemaps">@Html.Raw(StaticEnum.Sitemap(item.IsSitemap))</a>
                                }
                                else
                                {
                                    @Html.Raw(StaticEnum.Sitemap(item.IsSitemap))
                                }
                            </td>
                            <td class="act_delete">
                                @if (Model.SystemActionAdmin.Add == true)
                                {
                                    <a href="#@item.ID" class="add btn" title="Thêm">
                                        <span class="lnr lnr-plus-circle"></span>
                                    </a>
                                }
                                @if (!string.IsNullOrEmpty(item.NameAscii) || !string.IsNullOrEmpty(item.LinkUrl))
                                {
                                    <a href="@(string.IsNullOrEmpty(item.LinkUrl) ? Utility.Link(item.NameAscii,string.Empty,item.LinkUrl) : item.LinkUrl)" data-toggle="tooltip" data-placement="bottom" target="_blank" class="quickview" title="Xem">
                                        <span class="lnr lnr-eye"></span>
                                    </a>
                                }
                                @if (Model.SystemActionAdmin.Edit == true)
                                {
                                    <a href="#@item.ID" class="edit" data-toggle="tooltip" data-tab="" data-placement="bottom" title="Sửa">
                                        <span class="lnr lnr-pencil"></span>
                                    </a>
                                }
                                @if (Model.SystemActionAdmin.Delete == true)
                                {
                                    <a href="#@item.ID" class="delete" data-toggle="tooltip" data-placement="bottom" title="Xóa">
                                        <span class="lnr lnr-trash"></span>
                                    </a>
                                }
                            </td>
                            <td class="text-center">
                                <div class="label-check">
                                    <input type="checkbox" data-url="@item.UrlPicture" id="Check@(item.ID)" data-title="@item.Name" class="minimal check" value="@item.ID">
                                    <label for="Check@(item.ID)"></label>
                                </div>
                            </td>
                        </tr>
                        foreach (var child in Model.ListItem.Where(x => x.ParentID == item.ID).OrderBy(x => x.OrderDisplay))
                        {
                            <tr id="item_@(child.ID)" class="child-@item.ID level-1@(child.IsShow != true ? " hid" : string.Empty) @(child.ID==Model.WebsiteModule.ID?" active":string.Empty)" data-id="@item.ID">
                                <td class="open-child active" data-id="@child.ID" data-level="2">
                                    <span class="lnr lnr-chevron-down"></span>
                                    @if (Model.SystemActionAdmin.Edit == true)
                                    {
                                        <a href="#@child.ID" class="edit" data-tab="">
                                            @Html.Raw(Utility.DisplayShowName(child.Name, child.IsShow))
                                        </a>
                                    }
                                    @if (Model.ListItem.Count(x => x.ParentID == child.ID) > 0)
                                    {
                                        <span class="badge badge-danger" style="margin-left:5px;">@Model.ListItem.Count(x => x.ParentID == child.ID)</span>
                                    }
                                </td>
                                <td>@child.ModuleType</td>
                                <td>
                                    @if (Model.ListModule.Any(x => x.Tag == "WebsiteContent"))
                                    {
                                        <a href="/Adminadc/WebsiteContent/Index#ModuleId=@child.ID" class="color-info">Tới bài viết</a>
                                    }
                                </td>
                                <td>
                                    @if (Model.SystemActionAdmin.Order)
                                    {
                                        <input type="number" class="InputOrderDisplay form-control" name="OrderDisplay" onchange="changeOrder('@child.ID', this.value)" value="@child.OrderDisplay" disabled />
                                    }
                                    else
                                    {
                                        @child.OrderDisplay
                                    }
                                </td>
                                <td class="text-center">
                                    @if (Model.SystemActionAdmin.Active == true)
                                    {
                                        <a href="#@child.ID" class="@(ConvertUtil.ToBool(child.IsShow)==true?"hiddens":"show")">@Html.Raw(StaticEnum.Show(child.IsShow))</a>
                                    }
                                    else
                                    {
                                        @Html.Raw(StaticEnum.Show(child.IsShow))
                                    }
                                    @if (Model.SystemActionAdmin.Sitemap == true)
                                    {
                                        <a href="#@child.ID" class="sitemaps">@Html.Raw(StaticEnum.Sitemap(child.IsSitemap))</a>
                                    }
                                </td>
                                <td class="act_delete">
                                    @if (Model.SystemActionAdmin.Add == true)
                                    {
                                        <a href="#@child.ID" class="add btn" title="Thêm">
                                            <span class="lnr lnr-plus-circle"></span>
                                        </a>
                                    }
                                    @if (!string.IsNullOrEmpty(child.NameAscii) || !string.IsNullOrEmpty(child.LinkUrl))
                                    {
                                        <a href="@(string.IsNullOrEmpty(child.LinkUrl) ? Utility.Link(child.NameAscii,string.Empty,child.LinkUrl) : child.LinkUrl)" data-toggle="tooltip" data-placement="bottom" target="_blank" class="quickview" title="Đường dẫn xem">
                                            <span class="lnr lnr-eye"></span>
                                        </a>
                                    }
                                    @if (Model.SystemActionAdmin.Edit == true)
                                    {
                                        <a href="#@child.ID" class="edit" data-toggle="tooltip" data-tab="" data-placement="bottom" title="Sửa">
                                            <span class="lnr lnr-pencil"></span>
                                        </a>
                                    }
                                    @if (Model.SystemActionAdmin.Delete == true)
                                    {
                                        <a href="#@child.ID" class="delete" data-toggle="tooltip" data-placement="bottom" title="Xóa">
                                            <span class="lnr lnr-trash"></span>
                                        </a>
                                    }
                                </td>
                                <td class="text-center">
                                    <div class="label-check">
                                        <input type="checkbox" data-url="@child.UrlPicture" id="Check@(child.ID)" data-title="@child.Name" class="minimal check" value="@child.ID">
                                        <label for="Check@(child.ID)"></label>
                                    </div>
                                </td>
                            </tr>
                            foreach (var child2 in Model.ListItem.Where(x => x.ParentID == child.ID).OrderBy(x => x.OrderDisplay))
                            {
                                <tr id="item_@(child2.ID)" class="child-@item.ID child-@child.ID level-2@(child2.IsShow != true ? " hid" : string.Empty) @(child2.ID==Model.WebsiteModule.ID?" active":string.Empty)" data-id="@child.ID">
                                    <td class="open-child active" data-id="@child2.ID" data-level="3">
                                        <span class="lnr lnr-chevron-down"></span>
                                        @if (Model.SystemActionAdmin.Edit == true)
                                        {
                                            <a href="#@child2.ID" class="edit" data-tab="">
                                                @Html.Raw(Utility.DisplayShowName(child2.Name, child2.IsShow))
                                            </a>
                                        }
                                        @if (Model.ListItem.Count(x => x.ParentID == child2.ID) > 0)
                                        {
                                            <span class="badge badge-danger" style="margin-left:5px;">@Model.ListItem.Count(x => x.ParentID == child2.ID)</span>
                                        }
                                    </td>
                                    <td>@child2.ModuleType</td>
                                    <td>
                                        @if (Model.ListModule.Any(x => x.Tag == "WebsiteContent"))
                                        {
                                            <a href="/Adminadc/WebsiteContent/Index#ModuleId=@child2.ID" class="color-info">Tới bài viết</a>
                                        }
                                    </td>
                                    <td>
                                        @if (Model.SystemActionAdmin.Order)
                                        {
                                            <input type="number" class="InputOrderDisplay form-control" name="OrderDisplay" onchange="changeOrder('@child2.ID', this.value)" value="@child2.OrderDisplay" disabled />
                                        }
                                        else
                                        {
                                            @child2.OrderDisplay
                                        }
                                    </td>
                                    <td class="text-center">
                                        @if (Model.SystemActionAdmin.Active == true)
                                        {
                                            <a href="#@child2.ID" class="@(ConvertUtil.ToBool(child2.IsShow)==true?"hiddens":"show")">@Html.Raw(StaticEnum.Show(child2.IsShow))</a>
                                        }
                                        else
                                        {
                                            @Html.Raw(StaticEnum.Show(child2.IsShow))
                                        }
                                        @if (Model.SystemActionAdmin.Sitemap == true)
                                        {
                                            <a href="#@child2.ID" class="sitemaps">@Html.Raw(StaticEnum.Sitemap(child2.IsSitemap))</a>
                                        }
                                        else
                                        {
                                            @Html.Raw(StaticEnum.Sitemap(child2.IsSitemap))
                                        }
                                    </td>
                                    <td class="act_delete">
                                        @if (Model.SystemActionAdmin.Add == true)
                                        {
                                            <a href="#@child2.ID" class="add btn" title="Thêm">
                                                <span class="lnr lnr-plus-circle"></span>
                                            </a>
                                        }

                                        @if (!string.IsNullOrEmpty(child2.NameAscii) || !string.IsNullOrEmpty(child2.LinkUrl))
                                        {
                                            <a href="@(string.IsNullOrEmpty(child2.LinkUrl) ? Utility.Link(child2.NameAscii,string.Empty,child2.LinkUrl) : child2.LinkUrl)" data-toggle="tooltip" data-placement="bottom" target="_blank" class="quickview" title="Đường dẫn xem">
                                                <span class="lnr lnr-eye"></span>
                                            </a>
                                        }
                                        @if (Model.SystemActionAdmin.Edit == true)
                                        {
                                            <a href="#@child2.ID" class="edit" data-toggle="tooltip" data-tab="" data-placement="bottom" title="Sửa">
                                                <span class="lnr lnr-pencil"></span>
                                            </a>
                                        }
                                        @if (Model.SystemActionAdmin.Delete == true)
                                        {
                                            <a href="#@child2.ID" class="delete" data-toggle="tooltip" data-placement="bottom" title="Xóa">
                                                <span class="lnr lnr-trash"></span>
                                            </a>
                                        }
                                    </td>
                                    <td class="text-center">
                                        <div class="label-check">
                                            <input type="checkbox" data-url="@child2.UrlPicture" id="Check@(child2.ID)" data-title="@child2.Name" class="minimal check" value="@child2.ID">
                                            <label for="Check@(child2.ID)"></label>
                                        </div>
                                    </td>
                                </tr>
                                @foreach (var child3 in Model.ListItem.Where(x => x.ParentID == child2.ID).OrderBy(x => x.OrderDisplay))
                                {
                                    <tr id="item_@(child3.ID)" class="child-@item.ID child-@child.ID child-@child2.ID level-3@(child3.IsShow != true ? " hid" : string.Empty) @(child3.ID==Model.WebsiteModule.ID?" active":string.Empty)" data-id="@child2.ID">
                                        <td class="open-child active" data-id="@child3.ID" data-level="4">
                                            <span class="lnr lnr-chevron-down"></span>
                                            @if (Model.SystemActionAdmin.Edit == true)
                                            {
                                                <a href="#@child3.ID" class="edit" data-tab="">
                                                    @Html.Raw(Utility.DisplayShowName(child3.Name, child3.IsShow))
                                                </a>
                                            }
                                            @if (Model.ListItem.Count(x => x.ParentID == child3.ID) > 0)
                                            {
                                                <span class="badge badge-danger" style="margin-left:5px;">@Model.ListItem.Count(x => x.ParentID == child3.ID)</span>
                                            }
                                        </td>
                                        <td>@child3.ModuleType</td>
                                        <td>
                                            @if (Model.ListModule.Any(x => x.Tag == "WebsiteContent"))
                                            {
                                                <a href="/Adminadc/WebsiteContent/Index#ModuleId=@child3.ID" class="color-info">Tới bài viết</a>
                                            }
                                        </td>
                                        <td>
                                            @if (Model.SystemActionAdmin.Order)
                                            {
                                                <input type="number" class="InputOrderDisplay form-control" name="OrderDisplay" onchange="changeOrder('@child3.ID', this.value)" value="@child3.OrderDisplay" disabled />
                                            }
                                            else
                                            {
                                                @child3.OrderDisplay
                                            }
                                        </td>
                                        <td class="text-center">
                                            @if (Model.SystemActionAdmin.Active == true)
                                            {
                                                <a href="#@child3.ID" class="@(ConvertUtil.ToBool(child3.IsShow)==true?"hiddens":"show")">@Html.Raw(StaticEnum.Show(child3.IsShow))</a>
                                            }
                                            else
                                            {
                                                @Html.Raw(StaticEnum.Show(child3.IsShow))
                                            }
                                            @if (Model.SystemActionAdmin.Sitemap == true)
                                            {
                                                <a href="#@child3.ID" class="sitemaps">@Html.Raw(StaticEnum.Sitemap(child3.IsSitemap))</a>
                                            }
                                            else
                                            {
                                                @Html.Raw(StaticEnum.Sitemap(child3.IsSitemap))
                                            }
                                        </td>
                                        <td class="act_delete">
                                            @if (Model.SystemActionAdmin.Add == true)
                                            {
                                                <a href="#@child3.ID" class="add btn" title="Thêm">
                                                    <span class="lnr lnr-plus-circle"></span>
                                                </a>
                                            }

                                            @if (!string.IsNullOrEmpty(child3.NameAscii) || !string.IsNullOrEmpty(child3.LinkUrl))
                                            {
                                                <a href="@(string.IsNullOrEmpty(child3.LinkUrl) ? Utility.Link(child3.NameAscii,string.Empty,child3.LinkUrl) : child3.LinkUrl)" data-toggle="tooltip" data-placement="bottom" target="_blank" class="quickview" title="Đường dẫn xem">
                                                    <span class="lnr lnr-eye"></span>
                                                </a>
                                            }
                                            @if (Model.SystemActionAdmin.Edit == true)
                                            {
                                                <a href="#@child3.ID" class="edit" data-toggle="tooltip" data-tab="" data-placement="bottom" title="Sửa">
                                                    <span class="lnr lnr-pencil"></span>
                                                </a>
                                            }
                                            @if (Model.SystemActionAdmin.Delete == true)
                                            {
                                                <a href="#@child3.ID" class="delete" data-toggle="tooltip" data-placement="bottom" title="Xóa">
                                                    <span class="lnr lnr-trash"></span>
                                                </a>
                                            }
                                        </td>
                                        <td class="text-center">
                                            <div class="label-check">
                                                <input type="checkbox" data-url="@child3.UrlPicture" id="Check@(child3.ID)" data-title="@child3.Name" class="minimal check" value="@child3.ID">
                                                <label for="Check@(child3.ID)"></label>
                                            </div>
                                        </td>
                                    </tr>
                                }
                            }
                        }
                    }
                }
                else
                {
                    foreach (var item in Model.ListItem.Where(x => x.ParentID == 0))
                    {
                        <tr id="item_@(item.ID)" class="@(item.IsShow != true ? "hid" : string.Empty)@(item.ID==Model.WebsiteModule.ID?" active":string.Empty)">
                            <td class="open-child active" data-id="@item.ID" data-level="1">
                                <span class="lnr lnr-chevron-down"></span>
                                @if (Model.SystemActionAdmin.Edit == true)
                                {
                                    <a href="#@item.ID" class="edit" data-tab="">
                                        @Html.Raw(Utility.DisplayShowName(item.Name, item.IsShow))
                                    </a>
                                }
                                @if (Model.ListItem.Count(x => x.ParentID == item.ID) > 0)
                                {
                                    <span class="badge badge-danger" style="margin-left:5px;">@Model.ListItem.Count(x => x.ParentID == item.ID)</span>
                                }
                            </td>
                            <td>@item.ModuleType</td>
                            <td>
                                @if (Model.ListModule.Any(x => x.Tag == "WebsiteContent"))
                                {
                                    <a href="/Adminadc/WebsiteContent/Index#ModuleId=@item.ID" class="color-info">Tới bài viết</a>
                                }
                            </td>
                            <td>
                                @if (Model.SystemActionAdmin.Order)
                                {
                                    <input type="number" class="InputOrderDisplay form-control" name="OrderDisplay" onchange="changeOrder('@item.ID', this.value)" value="@item.OrderDisplay" disabled />
                                }
                                else
                                {
                                    @item.ID
                                }
                            </td>
                            <td class="text-center">
                                @if (Model.SystemActionAdmin.Active == true)
                                {
                                    <a href="#@item.ID" class="@(ConvertUtil.ToBool(item.IsShow)==true?"hiddens":"show")">@Html.Raw(StaticEnum.Show(item.IsShow))</a>
                                }
                                else
                                {
                                    @Html.Raw(StaticEnum.Show(item.IsShow))
                                }
                                @if (Model.SystemActionAdmin.Sitemap == true)
                                {
                                    <a href="#@item.ID" class="sitemaps">@Html.Raw(StaticEnum.Sitemap(item.IsSitemap))</a>
                                }
                                else
                                {
                                    @Html.Raw(StaticEnum.Sitemap(item.IsSitemap))
                                }
                            </td>
                            <td class="act_delete">
                                @if (Model.SystemActionAdmin.Add == true)
                                {
                                    <a href="#@item.ID" class="add btn" title="Thêm">
                                        <span class="lnr lnr-plus-circle"></span>
                                    </a>
                                }
                                @if (!string.IsNullOrEmpty(item.NameAscii) || !string.IsNullOrEmpty(item.LinkUrl))
                                {
                                    <a href="@(string.IsNullOrEmpty(item.LinkUrl) ? Utility.Link(item.NameAscii,string.Empty,item.LinkUrl) : item.LinkUrl)" data-toggle="tooltip" data-placement="bottom" target="_blank" class="quickview" title="Xem">
                                        <span class="lnr lnr-eye"></span>
                                    </a>
                                }
                                @if (Model.SystemActionAdmin.Edit == true)
                                {
                                    <a href="#@item.ID" class="edit" data-toggle="tooltip" data-tab="" data-placement="bottom" title="Sửa">
                                        <span class="lnr lnr-pencil"></span>
                                    </a>
                                }
                                @if (Model.SystemActionAdmin.Delete == true)
                                {
                                    <a href="#@item.ID" class="delete" data-toggle="tooltip" data-placement="bottom" title="Xóa">
                                        <span class="lnr lnr-trash"></span>
                                    </a>
                                }
                            </td>
                            <td class="text-center">
                                <div class="label-check">
                                    <input type="checkbox" data-url="@item.UrlPicture" id="Check@(item.ID)" data-title="@item.Name" class="minimal check" value="@item.ID">
                                    <label for="Check@(item.ID)"></label>
                                </div>
                            </td>
                        </tr>
                        foreach (var child in Model.ListItem.Where(x => x.ParentID == item.ID).OrderBy(x => x.OrderDisplay))
                        {
                            <tr id="item_@(child.ID)" class="child-@item.ID level-1@(child.IsShow != true ? " hid" : string.Empty) @(child.ID==Model.WebsiteModule.ID?" active":string.Empty)" data-id="@item.ID">
                                <td class="open-child active" data-id="@child.ID" data-level="2">
                                    <span class="lnr lnr-chevron-down"></span>
                                    @if (Model.SystemActionAdmin.Edit == true)
                                    {
                                        <a href="#@child.ID" class="edit" data-tab="">
                                            @Html.Raw(Utility.DisplayShowName(child.Name, child.IsShow))
                                        </a>
                                    }
                                    @if (Model.ListItem.Count(x => x.ParentID == child.ID) > 0)
                                    {
                                        <span class="badge badge-danger" style="margin-left:5px;">@Model.ListItem.Count(x => x.ParentID == child.ID)</span>
                                    }
                                </td>
                                <td>@child.ModuleType</td>
                                <td>
                                    @if (Model.ListModule.Any(x => x.Tag == "WebsiteContent"))
                                    {
                                        <a href="/Adminadc/WebsiteContent/Index#ModuleId=@child.ID" class="color-info">Tới bài viết</a>
                                    }
                                </td>
                                <td>
                                    @if (Model.SystemActionAdmin.Order)
                                    {
                                        <input type="number" class="InputOrderDisplay form-control" name="OrderDisplay" onchange="changeOrder('@child.ID', this.value)" value="@child.OrderDisplay" disabled />
                                    }
                                    else
                                    {
                                        @child.OrderDisplay
                                    }
                                </td>
                                <td class="text-center">
                                    @if (Model.SystemActionAdmin.Active == true)
                                    {
                                        <a href="#@child.ID" class="@(ConvertUtil.ToBool(child.IsShow)==true?"hiddens":"show")">@Html.Raw(StaticEnum.Show(child.IsShow))</a>
                                    }
                                    else
                                    {
                                        @Html.Raw(StaticEnum.Show(child.IsShow))
                                    }
                                    @if (Model.SystemActionAdmin.Sitemap == true)
                                    {
                                        <a href="#@child.ID" class="sitemaps">@Html.Raw(StaticEnum.Sitemap(child.IsSitemap))</a>
                                    }
                                </td>
                                <td class="act_delete">
                                    @if (Model.SystemActionAdmin.Add == true)
                                    {
                                        <a href="#@child.ID" class="add btn" title="Thêm">
                                            <span class="lnr lnr-plus-circle"></span>
                                        </a>
                                    }
                                    @if (!string.IsNullOrEmpty(child.NameAscii) || !string.IsNullOrEmpty(child.LinkUrl))
                                    {
                                        <a href="@(string.IsNullOrEmpty(child.LinkUrl) ? Utility.Link(child.NameAscii,string.Empty,child.LinkUrl) : child.LinkUrl)" data-toggle="tooltip" data-placement="bottom" target="_blank" class="quickview" title="Đường dẫn xem">
                                            <span class="lnr lnr-eye"></span>
                                        </a>
                                    }
                                    @if (Model.SystemActionAdmin.Edit == true)
                                    {
                                        <a href="#@child.ID" class="edit" data-toggle="tooltip" data-tab="" data-placement="bottom" title="Sửa">
                                            <span class="lnr lnr-pencil"></span>
                                        </a>
                                    }
                                    @if (Model.SystemActionAdmin.Delete == true)
                                    {
                                        <a href="#@child.ID" class="delete" data-toggle="tooltip" data-placement="bottom" title="Xóa">
                                            <span class="lnr lnr-trash"></span>
                                        </a>
                                    }
                                </td>
                                <td class="text-center">
                                    <div class="label-check">
                                        <input type="checkbox" data-url="@child.UrlPicture" id="Check@(child.ID)" data-title="@child.Name" class="minimal check" value="@child.ID">
                                        <label for="Check@(child.ID)"></label>
                                    </div>
                                </td>
                            </tr>
                            foreach (var child2 in Model.ListItem.Where(x => x.ParentID == child.ID).OrderBy(x => x.OrderDisplay))
                            {
                                <tr id="item_@(child2.ID)" class="child-@item.ID child-@child.ID level-2@(child2.IsShow != true ? " hid" : string.Empty) @(child2.ID==Model.WebsiteModule.ID?" active":string.Empty)" data-id="@child.ID">
                                    <td class="open-child active" data-id="@child2.ID" data-level="3">
                                        <span class="lnr lnr-chevron-down"></span>
                                        @if (Model.SystemActionAdmin.Edit == true)
                                        {
                                            <a href="#@child2.ID" class="edit" data-tab="">
                                                @Html.Raw(Utility.DisplayShowName(child2.Name, child2.IsShow))
                                            </a>
                                        }
                                        @if (Model.ListItem.Count(x => x.ParentID == child2.ID) > 0)
                                        {
                                            <span class="badge badge-danger" style="margin-left:5px;">@Model.ListItem.Count(x => x.ParentID == child2.ID)</span>
                                        }
                                    </td>
                                    <td>@child2.ModuleType</td>
                                    <td>
                                        @if (Model.ListModule.Any(x => x.Tag == "WebsiteContent"))
                                        {
                                            <a href="/Adminadc/WebsiteContent/Index#ModuleId=@child2.ID" class="color-info">Tới bài viết</a>
                                        }
                                    </td>
                                    <td>
                                        @if (Model.SystemActionAdmin.Order)
                                        {
                                            <input type="number" class="InputOrderDisplay form-control" name="OrderDisplay" onchange="changeOrder('@child2.ID', this.value)" value="@child2.OrderDisplay" disabled />
                                        }
                                        else
                                        {
                                            @child2.OrderDisplay
                                        }
                                    </td>
                                    <td class="text-center">
                                        @if (Model.SystemActionAdmin.Active == true)
                                        {
                                            <a href="#@child2.ID" class="@(ConvertUtil.ToBool(child2.IsShow)==true?"hiddens":"show")">@Html.Raw(StaticEnum.Show(child2.IsShow))</a>
                                        }
                                        else
                                        {
                                            @Html.Raw(StaticEnum.Show(child2.IsShow))
                                        }
                                        @if (Model.SystemActionAdmin.Sitemap == true)
                                        {
                                            <a href="#@child2.ID" class="sitemaps">@Html.Raw(StaticEnum.Sitemap(child2.IsSitemap))</a>
                                        }
                                        else
                                        {
                                            @Html.Raw(StaticEnum.Sitemap(child2.IsSitemap))
                                        }
                                    </td>
                                    <td class="act_delete">
                                        @if (Model.SystemActionAdmin.Add == true)
                                        {
                                            <a href="#@child2.ID" class="add btn" title="Thêm">
                                                <span class="lnr lnr-plus-circle"></span>
                                            </a>
                                        }

                                        @if (!string.IsNullOrEmpty(child2.NameAscii) || !string.IsNullOrEmpty(child2.LinkUrl))
                                        {
                                            <a href="@(string.IsNullOrEmpty(child2.LinkUrl) ? Utility.Link(child2.NameAscii,string.Empty,child2.LinkUrl) : child2.LinkUrl)" data-toggle="tooltip" data-placement="bottom" target="_blank" class="quickview" title="Đường dẫn xem">
                                                <span class="lnr lnr-eye"></span>
                                            </a>
                                        }
                                        @if (Model.SystemActionAdmin.Edit == true)
                                        {
                                            <a href="#@child2.ID" class="edit" data-toggle="tooltip" data-tab="" data-placement="bottom" title="Sửa">
                                                <span class="lnr lnr-pencil"></span>
                                            </a>
                                        }
                                        @if (Model.SystemActionAdmin.Delete == true)
                                        {
                                            <a href="#@child2.ID" class="delete" data-toggle="tooltip" data-placement="bottom" title="Xóa">
                                                <span class="lnr lnr-trash"></span>
                                            </a>
                                        }
                                    </td>
                                    <td class="text-center">
                                        <div class="label-check">
                                            <input type="checkbox" data-url="@child2.UrlPicture" id="Check@(child2.ID)" data-title="@child2.Name" class="minimal check" value="@child2.ID">
                                            <label for="Check@(child2.ID)"></label>
                                        </div>
                                    </td>
                                </tr>
                                @foreach (var child3 in Model.ListItem.Where(x => x.ParentID == child2.ID).OrderBy(x => x.OrderDisplay))
                                {
                                    <tr id="item_@(child3.ID)" class="child-@item.ID child-@child.ID child-@child2.ID level-3@(child3.IsShow != true ? " hid" : string.Empty) @(child3.ID==Model.WebsiteModule.ID?" active":string.Empty)" data-id="@child2.ID">
                                        <td class="open-child active" data-id="@child3.ID" data-level="4">
                                            <span class="lnr lnr-chevron-down"></span>
                                            @if (Model.SystemActionAdmin.Edit == true)
                                            {
                                                <a href="#@child3.ID" class="edit" data-tab="">
                                                    @Html.Raw(Utility.DisplayShowName(child3.Name, child3.IsShow))
                                                </a>
                                            }
                                            @if (Model.ListItem.Count(x => x.ParentID == child3.ID) > 0)
                                            {
                                                <span class="badge badge-danger" style="margin-left:5px;">@Model.ListItem.Count(x => x.ParentID == child3.ID)</span>
                                            }
                                        </td>
                                        <td>@child3.ModuleType</td>
                                        <td>
                                            @if (Model.ListModule.Any(x => x.Tag == "WebsiteContent"))
                                            {
                                                <a href="/Adminadc/WebsiteContent/Index#ModuleId=@child3.ID" class="color-info">Tới bài viết</a>
                                            }
                                        </td>
                                        <td>
                                            @if (Model.SystemActionAdmin.Order)
                                            {
                                                <input type="number" class="InputOrderDisplay form-control" name="OrderDisplay" onchange="changeOrder('@child3.ID', this.value)" value="@child3.OrderDisplay" disabled />
                                            }
                                            else
                                            {
                                                @child3.OrderDisplay
                                            }
                                        </td>
                                        <td class="text-center">
                                            @if (Model.SystemActionAdmin.Active == true)
                                            {
                                                <a href="#@child3.ID" class="@(ConvertUtil.ToBool(child3.IsShow)==true?"hiddens":"show")">@Html.Raw(StaticEnum.Show(child3.IsShow))</a>
                                            }
                                            else
                                            {
                                                @Html.Raw(StaticEnum.Show(child3.IsShow))
                                            }
                                            @if (Model.SystemActionAdmin.Sitemap == true)
                                            {
                                                <a href="#@child3.ID" class="sitemaps">@Html.Raw(StaticEnum.Sitemap(child3.IsSitemap))</a>
                                            }
                                            else
                                            {
                                                @Html.Raw(StaticEnum.Sitemap(child3.IsSitemap))
                                            }
                                        </td>
                                        <td class="act_delete">
                                            @if (Model.SystemActionAdmin.Add == true)
                                            {
                                                <a href="#@child3.ID" class="add btn" title="Thêm">
                                                    <span class="lnr lnr-plus-circle"></span>
                                                </a>
                                            }

                                            @if (!string.IsNullOrEmpty(child3.NameAscii) || !string.IsNullOrEmpty(child3.LinkUrl))
                                            {
                                                <a href="@(string.IsNullOrEmpty(child3.LinkUrl) ? Utility.Link(child3.NameAscii,string.Empty,child3.LinkUrl) : child3.LinkUrl)" data-toggle="tooltip" data-placement="bottom" target="_blank" class="quickview" title="Đường dẫn xem">
                                                    <span class="lnr lnr-eye"></span>
                                                </a>
                                            }
                                            @if (Model.SystemActionAdmin.Edit == true)
                                            {
                                                <a href="#@child3.ID" class="edit" data-toggle="tooltip" data-tab="" data-placement="bottom" title="Sửa">
                                                    <span class="lnr lnr-pencil"></span>
                                                </a>
                                            }
                                            @if (Model.SystemActionAdmin.Delete == true)
                                            {
                                                <a href="#@child3.ID" class="delete" data-toggle="tooltip" data-placement="bottom" title="Xóa">
                                                    <span class="lnr lnr-trash"></span>
                                                </a>
                                            }
                                        </td>
                                        <td class="text-center">
                                            <div class="label-check">
                                                <input type="checkbox" data-url="@child3.UrlPicture" id="Check@(child3.ID)" data-title="@child3.Name" class="minimal check" value="@child3.ID">
                                                <label for="Check@(child3.ID)"></label>
                                            </div>
                                        </td>
                                    </tr>
                                }
                            }
                        }
                    }
                }
            }
        </tbody>
    </table>
    <script type="text/javascript">
        $(document).ready(function () {
            registerGridView("#gridItems");
            $('.open-child .lnr-chevron-down').click(function () {
                let parent = $(this).parents('.open-child')
                let id = parent.data('id');
                if (parent.hasClass('active')) {
                    $('.child-' + id).addClass('hide');
                    $('.child-' + id + ' .open-child').removeClass('active');
                    parent.removeClass('active');
                }
                else {
                    let lvel = parent.data('level');
                    $('.child-' + id + '.level-' + lvel).removeClass('hide');
                    parent.addClass('active');
                }
            });
            $('#ShowAll').click(function () {
                $("tr[class^='child-']").removeClass('hide');
                $('table tr td').addClass('active');
            });
            $('#HideAll').click(function () {
                $("tr[class^='child-']").addClass('hide');
                $('table tr td').removeClass('active');
            });
            $('.updateproducts').click(function (e) {
                e.preventDefault();
                $("#gridItems input.check[type='checkbox']:checked").not("#checkAll").not(".checkAll").each(function () {
                    var thisurl = $(this).val();
                    var url = "/Adminadc/WebsiteModule/UpdateTotalProducts?id=" + thisurl;
                    $.ajax({
                        url: encodeURI(url), cache: false, type: "Post",
                        success: function (data) {
                            var sc = $('#status-success').text();
                            var total = $('#status-total').text();
                            $('#status-success').text(parseInt(sc) + 1);
                            $('#status-total').text(parseInt(total) + 1);
                        },
                        error: function (data) {
                            var total = $('#status-total').text();
                            $('#status-total').text(parseInt(total) + 1);
                        }
                    });
                });
                $(this).parents('.btn-group').removeClass('open');
                return false;
            });
        });
    </script>
    <style>
        #gridItems tr td:first-child {
            font-weight: 700;
        }

        .level-1 td:nth-child(1) {
            padding-left: 22px;
        }

        .level-2 td:nth-child(1) {
            padding-left: 41px;
        }

        .level-3 td:nth-child(1) {
            padding-left: 60px;
        }

        .level-4 td:nth-child(1) {
            padding-left: 80px;
        }

        #gridItems tr.level-1 td:first-child, #gridItems tr.level-2 td:first-child, #gridItems tr.level-3 td:first-child, #gridItems tr.level-4 td:first-child {
            font-weight: 400
        }

        #gridItems tr td.active:first-child .badge {
            display: none;
        }

        .lnr-chevron-down, .open-child {
            cursor: pointer;
            margin-right: 5px;
        }

        a.show {
            display: inline-block !important;
        }
    </style>
    @if (Model.WebsiteModule.ID > 0)
    {
        <script>
            $(function () {
                var item = $('#item_@(Model.WebsiteModule.ID)');
                if (item.length > 0) {
                    window.scrollTo(0, item.offset().top);
                }
            });
        </script>
    }
    <script>
        $(function () {
            $('table tbody tr.active').each(function () {
                var id = $(this).data('id');
                $('.child-' + id).removeClass('hide');
                var parent = $('#item_' + id).data('id');
                $('.child-' + parent).removeClass('hide');
            });
            $('#Show option[value="@Model.SearchModel.Show"]').attr('selected', 'selected');
            $('input[name=Keyword]').val('@Html.Raw(Model.SearchModel.keyword)');
        });
    </script>
}
